# ğŸ§‘ğŸ»â€ğŸ³ Share My Recipe!

> ë‚˜ë§Œì˜ ë ˆì‹œí”¼ë¥¼ ê³µìœ í•´ë´ìš”! ğŸ¥—


## ğŸ“Œ ëª©ì°¨
1. [ê°œìš”](#-ê°œìš”)
2. [ì‚¬ìš© ì–¸ì–´ ë° ê°œë°œ í™˜ê²½](#-ì‚¬ìš©-ì–¸ì–´-ë°-ê°œë°œ-í™˜ê²½)
3. [í”„ë¡œì íŠ¸ ëª©ì ](#-í”„ë¡œì íŠ¸-ëª©ì )
4. [DB êµ¬ì¡°](#-db-êµ¬ì¡°)
5. [êµ¬í˜„ ê¸°ëŠ¥](#-êµ¬í˜„-ê¸°ëŠ¥)
6. [í•™ìŠµ ë‚´ìš© & ê°œì„ ëœ ë‚´ìš©](#-í•™ìŠµ-ë‚´ìš©--ê°œì„ ëœ-ë‚´ìš©)



## âœ” ê°œìš”
* ê°œë°œ ê¸°ê°„
  * 2023.01.01 ~
* ê°œë°œ ì¸ì›
  * ê°œì¸ í”„ë¡œì íŠ¸


## âœ” ì‚¬ìš© ì–¸ì–´ ë° ê°œë°œ í™˜ê²½
- IntelliJ
- Java 11
- Spring Boot 2.7
- Maven
- Spring Data JPA
- MySQL
- Thymeleaf


## âœ” í”„ë¡œì íŠ¸ ëª©ì 
* êµ­ë¹„ êµìš±ì—ì„œ ë°°ìš´ MyBatisê°€ ì•„ë‹Œ, í›„ì— ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•œ 
  * **JPA** ì ìš©
  * **Custom Exception** ì ìš©
  * **DTO** ì ìš©
  * **Test Code** ì‘ì„±
  
  í”„ë¡œì íŠ¸

## âœ” DB êµ¬ì¡°
![](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/fabfbe87-79bc-4ba8-8906-2b569277681f/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230130%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230130T042206Z&X-Amz-Expires=86400&X-Amz-Signature=3c801411256bf5de2d5a1e7c6221c597c5cf9b50ec59851446d241c3d99b0af7&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject)



## âœ” êµ¬í˜„ ê¸°ëŠ¥
* Spring-Securityë¥¼ í™œìš©í•œ íšŒì›ê°€ì…
  * ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ì €ì¥
  * ì¤‘ë³µ ì•„ì´ë”” íšŒì›ê°€ì… ë¶ˆê°€ëŠ¥


* ë‚˜ë§Œì˜ ë ˆì‹œí”¼(ê²Œì‹œê¸€) ë“±ë¡
    * ë ˆì‹œí”¼(ê²Œì‹œê¸€) ë“±ë¡ / ìˆ˜ì • / ì‚­ì œ
    * ë ˆì‹œí”¼(ê²Œì‹œê¸€) ì´ë¯¸ì§€ ë“±ë¡
    * íšŒì›ì´ ì•„ë‹ ì‹œ ë ˆì‹œí”¼(ê²Œì‹œê¸€) ë“±ë¡ ë¶ˆê°€


* ê³µìœ ëœ ë ˆì‹œí”¼ ì €ì¥
  * íšŒì›ì´ ì•„ë‹ ì‹œ ë ˆì‹œí”¼(ê²Œì‹œê¸€) ì €ì¥ ë¶ˆê°€
  * ë ˆì‹œí”¼ ì¤‘ë³µ ì €ì¥ ë¶ˆê°€ëŠ¥


## âœ í•™ìŠµ ë‚´ìš© & ê°œì„ ëœ ë‚´ìš©
### 0. í”„ë¡œì íŠ¸ ëª©ì  ë³€ê²½
> View Pageì—ë§Œ ì§‘ì¤‘ â†’ ì½”ë“œì— ì§‘ì¤‘
<details>
<summary>[ì´ì „ ìƒí™©] ë³´ì—¬ì§€ëŠ” View Pageì—ë§Œ ì§‘ì¤‘</summary>
<div markdown="1">

```
êµ­ë¹„êµìœ¡ì„ ë°›ìœ¼ë©° íŒ€ & ê°œì¸ í”„ë¡œì íŠ¸ë¥¼ í–ˆì„ ì‹œì—” ë³´ì—¬ì§€ëŠ” View Pageì—ë§Œ ì§‘ì¤‘í–ˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì½”ë“œê°€ ì–´ë–»ê²Œ ëë“ , 
ë³´ì—¬ì§€ëŠ” í™”ë©´(View)ë§Œ ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œë” ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
ê·¸ ê²°ê³¼ 
ì–´ë–¤ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë©´, ë‹¤ë¥¸ ê¸°ëŠ¥ì— ë¬¸ì œê°€ ìƒê¸°ê³  
ê·¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©´, ë˜ë‹¤ë¥¸ ë¬¸ì œê°€ ìƒê¸°ëŠ” ìƒí™©ì´ ë°˜ë³µëìŠµë‹ˆë‹¤.

ê·¼ë³¸ì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í•˜ê³  ë¬¸ì œ ìƒí™©ì„ ë§‰ê¸°ì—ë§Œ ê¸‰í–ˆìŠµë‹ˆë‹¤.
ê²°ê³¼ì ìœ¼ë¡ , ë§¤ìš° ì§€ì €ë¶„í•˜ê³  ì•Œ ìˆ˜ ì—†ëŠ” 
ì¦‰, ìœ ì§€ë³´ìˆ˜ê°€ ë§¤ìš° ì–´ë ¤ìš´ ì½”ë“œê°€ ìµœì¢… ê²°ê³¼ë¬¼ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

ê·¸ë•Œì—ëŠ” ê·¸ ë°©ì‹ì´ ë§ëŠ” ë°©ì‹ì¸ ì¤„ ì•Œì•˜ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ UIì— ì‹ ê²½ì“°ëŠ” ê²ƒì´ ì•„ë‹Œ ê¸°ëŠ¥ êµ¬í˜„ ì½”ë“œì— ì§‘ì¤‘í•´ì•¼í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê²Œë˜ì—ˆê³ , 
ì´ë²ˆ í”„ë¡œì íŠ¸ë¶€í„´ ì½”ë“œì— ì§‘ì¤‘í•˜ëŠ” ê²ƒìœ¼ë¡œ ëª©ì ì„ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.
```
</div>
</details>

<details>
<summary>[ì´ë²ˆ í”„ë¡œì íŠ¸ ì‹œ] ê¸°ëŠ¥ êµ¬í˜„ ì½”ë“œì— ì§‘ì¤‘</summary>
<div markdown="1">

```
ì œì¼ í° ë³€í™”ëŠ” ì—¬íƒœê» ë°°ì›Œì™”ê³  ì ìš©ì‹œì¼°ë˜ MyBatisê°€ ì•„ë‹Œ, 
ìƒˆë¡­ê²Œ í•™ìŠµí•œ JPAë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

ë˜í•œ Test Codeë„ í”„ë¡œì íŠ¸ì— ì ìš©ì‹œì¼œë³´ì•˜ìŠµë‹ˆë‹¤.
ê·¸ì— ë”°ë¼ ì˜ˆì™¸ ìƒí™©ë“¤ì— ëŒ€í•œ ì½”ë“œë“¤ë„ ìƒê°í•´ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
```
</div>
</details>

<br>

### 1. JPA ì ìš©í•˜ê¸°
> MyBatisë¥¼ ì‚¬ìš©í–ˆë˜ ì§€ë‚œ í”„ë¡œì íŠ¸ â†’ JPA ì ìš©í•˜ê¸°
<details>
<summary>[ì´ì „ ìƒí™©] MyBaisë¥¼ ì´ìš©í•´ êµ¬í˜„í–ˆë˜ ê²€ìƒ‰ ê¸°ëŠ¥ ì½”ë“œ, DB ì¿¼ë¦¬ë§Œ ë‚ ë ¸ë˜ í”„ë¡œì íŠ¸</summary>
<div markdown="1">

* Ex) ê²Œì‹œë¬¼ ê²€ìƒ‰
* [Controller]
```java
// ì§ì—… ê²€ìƒ‰
@RequestMapping("/jobsearchtest")
public String jobSearch(@RequestParam HashMap<String, Object> param, Model model) {
    ArrayList<JobVO> jobList = jobService.jobSearch(param);
    model.addAttribute("jobList", jobList);

    return "job/job_search_result";
}
```

* [SQL Mapper]
```xml
<!-- ê²Œì‹œë¬¼ ê²€ìƒ‰ -->
<select id="jobSearch" parameterType="hashmap" resultMap="jobResult">
	SELECT * FROM job WHERE
	jobName LIKE CONCAT('%', #{keyword}, '%')
</select>
```
</div>
</details>

<details>
<summary>[ì´ë²ˆ í”„ë¡œì íŠ¸ ì‹œ] JPAë¥¼ ì´ìš©í•´ êµ¬í˜„í•œ ê²€ìƒ‰ ê¸°ëŠ¥ ì½”ë“œ</summary>
<div markdown="1">

* querydslì„ ì ìš©ì‹œì¼œ ë³¸ ì½”ë“œ
```java
/**
 * ê²€ìƒ‰ì–´ê°€ nullì´ ì•„ë‹ˆë©´, ê²Œì‹œë¬¼ëª…ì— í•´ë‹¹ ê²€ìƒ‰ì–´ê°€ í¬í•¨ë˜ëŠ” ê²Œì‹œë¬¼ì„ ì¡°íšŒí•˜ëŠ” ì¡°ê±´ ë°˜í™˜
 *
 * BooleanExpression ; null ë°˜í™˜ ì‹œ ìë™ìœ¼ë¡œ ì¡°ê±´ì ˆì—ì„œ ì œê±°ë¨
 * ë‹¨, ëª¨ë“  ì¡°ê±´ì´ nullì¸ ê²½ìš° ì¥ì•  ë°œìƒ
 * */
private BooleanExpression recipeNameLike(String searchQuery) {
    return StringUtils.isEmpty(searchQuery) ? null : QRecipe.recipe.recipeName.like("%" + searchQuery + "%");
}
```
</div>
</details>

<br>

### 2. Custom Exception ì ìš©í•˜ê¸°
> ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì „í˜€ í•˜ì§€ ì•Šì•˜ë˜ ì§€ë‚œ í”„ë¡œì íŠ¸ â†’ ì˜ˆì™¸ ì²˜ë¦¬ ì ìš©
<details>
<summary>[ì´ì „ ìƒí™©] ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì „í˜€ í•˜ì§€ ì•Šì•˜ë˜ ì§€ë‚œ í”„ë¡œì íŠ¸ë“¤</summary>
<div markdown="1">

  * Ex) ë§ˆì´í˜ì´ì§€ì— ê²Œì‹œë¬¼ ì €ì¥ ì‹œ, ì¤‘ë³µ ì €ì¥ ì²˜ë¦¬
```java
// ë§ˆì´í˜ì´ì§€ ê²Œì‹œë¬¼ ì €ì¥
@ResponseBody
@RequestMapping("/insert_video")
public String insertVideo(@RequestParam HashMap<String, Object> param, HttpSession session) {
	String result = null;
	String memId = (String)session.getAttribute("sid");
	
	param.put("memId", memId);

	// ì €ì¥í•˜ë ¤ëŠ” ê²Œì‹œë¬¼ì´ ë§ˆì´í˜ì´ì§€ì— ìˆëŠ”ì§€ ê°¯ìˆ˜ë¥¼ ì²´í¬í•œë‹¤.
	int count = videoService.checkVideo(Integer.parseInt((String)param.get("videoNo")), memId);
	if(count == 0) { // ë§Œì•½ ê²Œì‹œë¬¼ì´ ì—†ë‹¤ë©´ (ë§ˆì´í˜ì´ì§€ ê²Œì‹œë¬¼ 0ê°œ)
		videoService.insertVideo(param);
		result = "0";
	}
	else { // ë§Œì•½ ê²Œì‹œë¬¼ì´ ìˆë‹¤ë©´, ì˜ë¯¸ì—†ëŠ” ìˆ«ì(result = 1) ë°˜í™˜
		result = "1";
	}
	
	return result;
}
```
</div>
</details>

<details>
<summary>[ì´ë²ˆ í”„ë¡œì íŠ¸ ì‹œ] ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì ìš©í•´ë³´ì•˜ë˜ ì´ë²ˆ í”„ë¡œì íŠ¸</summary>
<div markdown="1">

* Ex) ë§ˆì´í˜ì´ì§€ì— ê²Œì‹œë¬¼ ì €ì¥ ì‹œ, ì¤‘ë³µ ì €ì¥ ì²˜ë¦¬ : ë§ˆì´í˜ì´ì§€ ì»¨íŠ¸ë¡¤ëŸ¬
```java
try {
    cartRecipeId = cartService.addCart(cartRecipeDto, email);
} catch (AppException e) { // ë§Œë“¤ì–´ë†“ì€ AppExceptionìœ¼ë¡œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•œë‹¤.
    model.addAttribute("errorMessage", e.getMessage()); // ì˜ˆì™¸ì²˜ë¦¬ ë©”ì„¸ì§€ë¥¼ ë§ˆì´í˜ì´ì§€ viewì— ì „ë‹¬
    return new ResponseEntity<String>(e.getMessage(), HttpStatus.BAD_REQUEST);
}
```

* Service
```java
CartRecipe savedCartRecipe = cartRecipeRepository.findByCartIdAndRecipeId(cart.getId(), recipe.getId());

// ë ˆì‹œí”¼ ì¤‘ë³µ ì €ì¥
if(savedCartRecipe != null) { // ë§ˆì´í˜ì´ì§€ì— ê²Œì‹œë¬¼ì´ ì €ì¥ë˜ì–´ ìˆë‹¤ë©´ 
	// AppExceptionì˜ CART_RECIPE_DUPLICATEDë¡œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•œë‹¤.
  throw new AppException(ErrorCode.CART_RECIPE_DUPLICATED, recipe.getRecipeName() + "ì€ ì´ë¯¸ ì €ì¥ë˜ì–´ìˆìŠµë‹ˆë‹¤.");
}

CartRecipe cartRecipe = CartRecipe.createCartRecipe(cart, recipe);
cartRecipeRepository.save(cartRecipe);
```
</div>
</details>

<br>

### 3. DTO ì ìš©í•˜ê¸°
> DTOì˜ ì¡´ì¬ë¥¼ ëª°ë¼ Entityë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜ â†’ DTO ì ìš©
<details>
<summary>[ì´ì „ ìƒí™©] DTOì˜ ì¡´ì¬ë¥¼ ëª°ëë˜ ì§€ë‚œ í”„ë¡œì íŠ¸ë“¤</summary>
<div markdown="1">

* Ex) ëª¨ë“  ê²Œì‹œë¬¼ ì¶œë ¥
* [Controller] : DTOë¥¼ ìƒì„±í•˜ì§€ ì•Šê³ , Entityë¥¼ ë°”ë¡œ ë°˜í™˜í–ˆë‹¤.
```java
// ì „ì²´ ê²Œì‹œë¬¼ ì¶œë ¥
@RequestMapping("/job_index")
public String viewJobAllList(Model model) {

  // ê²Œì‹œë¬¼ Entityë¥¼ ê·¸ëŒ€ë¡œ Serivceì— ì „ë‹¬í•œë‹¤.
  ArrayList<JobVO> jobList = jobService.listAllJob();
  model.addAttribute("jobList", jobList); // View Pageì— Entityë¥¼ ë°”ë¡œ ì „ë‹¬í•œë‹¤.

  return "job/job_index";
}
```
</div>
</details>

<details>
<summary>[ì´ë²ˆ í”„ë¡œì íŠ¸ ì‹œ] DTOê°€ ì™œ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ”ì§€ í•™ìŠµí•˜ê³  ì ìš©</summary>
<div markdown="1">

* â€˜DTOë¥¼ ì™œ ë§Œë“œëŠ” ê²ƒì¸ê°€'ì— ëŒ€í•œ ê³ ì°°
* Ex) ëª¨ë“  ê²Œì‹œë¬¼ ì¶œë ¥
* [MainItemDto]
```java
@Setter
@Getter
public class MainItemDto {

    private Long id;
    private String recipeName;
    private String recipeDetail;
    private String imgUrl;
    private Integer price;

    @QueryProjection
    public MainItemDto(Long id, String recipeName, String recipeDetail, String imgUrl, Integer price) {
        this.id = id;
        this.recipeName = recipeName;
        this.recipeDetail = recipeDetail;
        this.imgUrl = imgUrl;
        this.price = price;
    }
}
```
</div>
</details>

<br>

### 4. Test Code ì‘ì„±í•˜ê¸°
> ë§¤ë²ˆ View Pageë¥¼ í†µí•´ ì˜ë„í•œ ê²°ê³¼ê°€ ë§ëŠ”ì§€ í™•ì¸ â†’ Test Code ì ìš©
<details>
<summary>[ì´ì „ ìƒí™©] Test Codeì˜ ì¡´ì¬ ìì²´ë¥¼ ëª°ëë˜ ì§€ë‚œ í”„ë¡œì íŠ¸ë“¤</summary>
<div markdown="1">

* Ex) Test View Pageë¥¼ ìƒì„±í•´ ì˜ë„í•œ ê²°ê³¼ê°€ ë§ê²Œ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸
* [test.jsp]
```html
<%@ page language="java" contentType="text/html; charset=UTF-8"
        pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<div style="width: 800px; height: 500px; background-color :red; display:flex; flex-direction:row;">
<div style="width: 50px; height:30px; margin:30px; background-color: blue;"></div>
<div style="width: 50px; height:30px;margin:30px; background-color: blue;"></div>
<div style="width: 50px; height:30px;margin:30px; background-color: blue;"></div>
<div style="width: 50px; height:30px;margin:30px; background-color: blue;"></div>
</div>

<script>


</script>
```
</div>
</details>

<details>
<summary>[ì´ë²ˆ í”„ë¡œì íŠ¸ ì‹œ] ì½”ë“œì— ì¢€ ë” ì§‘ì¤‘í•˜ê¸° ìœ„í•´ Test Codeë¥¼ ì ìš©</summary>
<div markdown="1">

* Ex) ì¤‘ë³µ íšŒì› ê°€ì… í…ŒìŠ¤íŠ¸
```java
// ì„ì˜ì˜ íšŒì› ì •ë³´ ìƒì„±
public Member createMember() {
    MemberFormDto memberFormDto = new MemberFormDto();
    memberFormDto.setEmail("test@email.com");
    memberFormDto.setName("ê¹€ê¸¸ë™");
    memberFormDto.setAddress("ê²½ê¸°ë„");
    memberFormDto.setPassword("1234");
    return Member.createMember(memberFormDto, passwordEncoder);
}

// ì¤‘ë³µ íšŒì› ê°€ì… í…ŒìŠ¤íŠ¸
@Test
@DisplayName("ì¤‘ë³µ íšŒì› ê°€ì… í…ŒìŠ¤íŠ¸")
public void saveDuplicateMemberTest(){
    Member member1 = createMember();
    Member member2 = createMember();
    memberService.saveMember(member1);
    Throwable e = assertThrows(AppException.class, () -> {
    memberService.saveMember(member2);});

    // ë°œìƒì‹œí‚¨ ì˜ˆì™¸ì²˜ë¦¬ ë©”ì„¸ì§€ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
    assertEquals("ê¹€ê¸¸ë™ì€ ì´ë¯¸ ìˆìŠµë‹ˆë‹¤.", e.getMessage());
}
```
</div>
</details>

<br>
<br>
<br>


